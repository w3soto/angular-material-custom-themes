@use 'sass:map';
@use 'sass:meta';
@use '@angular/material' as theming;


@mixin _ripple-background($palette, $hue, $opacity: 0.1) {
  $background-color: theming.get-color-from-palette($palette, $hue, $opacity);
  background-color: $background-color;
  @if (meta.type-of($background-color) != color) {
   opacity: $opacity;
  }
}


@mixin color($theme) {

  $custom-config: map.get($theme, custom);
  $custom-colors: map.get($custom-config, colors);

  $palettes: theming.get-color-config($custom-colors);

  .mat-button,
  .mat-icon-button,
  .mat-stroked-button {
    @each $key, $palette in $palettes {
      &[color=#{$key}],
      &.mat-#{$key} {
        color: map.get($palette, main);
        // focus
        .mat-button-focus-overlay {
          background-color: theming.get-color-from-palette($palette);
        }
      }
    }
  }

  .mat-raised-button,
  .mat-flat-button,
  .mat-fab,
  .mat-mini-fab {
    @each $key, $palette in $palettes {
      $contrast: map.get($palette, contrast);
      &[color=#{$key}],
      &.mat-#{$key} {
        background-color: map.get($palette, main);
        @if $contrast {
          color: map.get($contrast, main);
        }
        // ripple
        .mat-ripple-element {
          @include _ripple-background($palette, default-contrast);
        }
      }
    }
  }


}


@mixin typography($theme) {

  .mat-button,
  .mat-raised-button,
  .mat-stroked-button,
  .mat-flat-button {
    min-width: 2em;
    line-height: 40px;
    //  padding: 0 1.15em;
    //  margin: 0 .65em;
    .mat-button-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 4px;
    }
  }

  .mat-stroked-button {
    line-height: 38px;
  }

}


@mixin density($theme) {

  $dense-size: 28px;
  $dense-icon-size: 14px;

  .mat-button,
  .mat-raised-button,
  .mat-stroked-button,
  .mat-flat-button,
  .mat-icon-button,
  .mat-mini-fab {
    &[dense] {
      line-height: $dense-size;
      .mat-icon {
        height: $dense-icon-size;
        width: $dense-icon-size;
        font-size: $dense-icon-size;
        line-height: $dense-icon-size;
      }
    }
  }

  .mat-icon-button {
    &[dense] {
      width: $dense-size;
      height: $dense-size;
    }
  }

  .mat-mini-fab[dense] {
    width: $dense-size;
    height: $dense-size;
    .mat-button-wrapper {
      line-height: $dense-icon-size;
      padding: 4px 0;
    }
  }

}


@mixin theme($theme) {
  @include color($theme);
  @include typography($theme);
  @include density($theme);
}
